version = 1


[install]
treefmt.pkg-path = "treefmt"
nixfmt.pkg-path = "nixfmt-rfc-style"
shfmt.pkg-path = "shfmt"
jq.pkg-path = "jq"


[vars]
IOS_MIN_RUNTIME = "15.0"
IOS_MAX_RUNTIME = "26.1"
IOS_MIN_DEVICE = "iPhone 13"
IOS_MAX_DEVICE = "iPhone 17"
ANDROID_MIN_API = "21"
ANDROID_MAX_API = "33"
ANDROID_MIN_AVD = "pixel_API21_x86_64"
ANDROID_MIN_AVD_ARM = "pixel_API21_arm64_v8a"
ANDROID_MAX_AVD_X64 = "medium_phone_API33_x86_64"
ANDROID_MAX_AVD_ARM = "medium_phone_API33_arm64_v8a"

[hook]
 on-activate = '''
    export ROOT_PROJECT=$(git rev-parse --show-toplevel)
    script() {
      local name="${1:-}"
      shift || true
      if [ -z "$name" ]; then
        echo "Usage: script <name> [args...] (runs scripts/<name>.sh)" >&2
        return 1
      fi
      local project_root="${ROOT_PROJECT:-$(git rev-parse --show-toplevel 2>/dev/null || pwd)}"
      local path="$project_root/scripts/${name}.sh"
      if [ ! -x "$path" ]; then
        echo "script: $path not found or not executable" >&2
        return 1
      fi
      "$path" "$@"
    }
    # Ensure Yarn 4 from the env wins over any host Yarn 1.x
    clean_path="$(printf '%s' "$PATH" | tr ':' '\n' | grep -v '/.yarn/bin' | paste -sd: -)"
    export COREPACK_HOME="$HOME/.local/share/corepack"
    mkdir -p "$HOME/.local/bin" "$COREPACK_HOME"
    # Prefer the env-provided yarn binary explicitly if present.
    if command -v yarn >/dev/null 2>&1; then
      yarn_dir="$(dirname "$(command -v yarn)")"
      export PATH="$yarn_dir:$HOME/.local/bin:$COREPACK_HOME:$clean_path"
    else
      export PATH="$HOME/.local/bin:$COREPACK_HOME:$clean_path"
    fi
    if command -v corepack >/dev/null 2>&1; then
      corepack enable --install-directory "$HOME/.local/bin" >/dev/null 2>&1 || true
      corepack prepare "yarn@4.12.0" --activate --install-directory "$HOME/.local/bin" >/dev/null 2>&1 || true
      hash -r
    fi
 '''


[profile]


[services]
[include]


[build]
# [build.myproject]
# description = "The coolest project ever"
# version = "0.0.1"
# command = """
#   mkdir -p $out/bin
#   cargo build --release
#   cp target/release/myproject $out/bin/myproject
# """


[options]
