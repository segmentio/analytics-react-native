{
  "$schema": "https://raw.githubusercontent.com/jetify-com/devbox/0.14.2/.schema/devbox.schema.json",
  "include": [
    "github:segment-integrations/devbox-plugins?dir=plugins/android",
    "github:segment-integrations/devbox-plugins?dir=plugins/ios"
  ],
  "packages": {
    "yarn-berry": "latest",
    "treefmt": "latest",
    "nixfmt": "latest",
    "shfmt": "latest"
  },
  "shell": {
    "scripts": {
      "clean": [
        "rm -rf $DEVBOX_PROJECT_ROOT/examples/E2E/ios/Podfile.lock",
        "rm -rf $DEVBOX_PROJECT_ROOT/examples/E2E/ios/Pods",
        "yarn cache clean",
        "find $DEVBOX_PROJECT_DIR -type d -name node_modules -exec rmdir {} \\;"
      ],
      "build": ["yarn install --immutable", "yarn build", "yarn lint"],
      "format": ["treefmt"],
      "lint": ["treefmt --fail-on-change"],
      "test-android": [
        "yarn install",
        "yarn e2e install",
        "yarn build",
        "yarn e2e build:android",
        "yarn e2e test:android"
      ],
      "test-ios": [
        "yarn install",
        "yarn e2e install",
        "yarn e2e pods",
        "yarn build",
        "yarn e2e build:ios",
        "yarn e2e test:ios"
      ],
      "act-ci": [
        "bash $DEVBOX_PROJECT_ROOT/scripts/act-ci.sh --platform ubuntu-latest=ghcr.io/catthehacker/ubuntu:act-24.04"
      ],
      "update-apps": [
        "yarn install --no-immutable",
        "yarn e2e install --no-immutable",
        "yarn example install --no-immutable"
      ],
      "update-shells": [
        "devbox update",
        "devbox update --config=shells/devbox-fast.json"
      ],
      "test": ["devbox run test-android", "devbox run test-ios"]
    }
  }
}
